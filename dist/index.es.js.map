{"version":3,"file":"index.es.js","sources":["../src/form.js","../src/checkbox.js","../src/item.js"],"sourcesContent":["import React from \"react\";\nimport set from \"lodash/set\";\nimport forEach from \"lodash/forEach\";\nexport const form = settings => {\n  const initForm = {};\n  forEach(settings, ({ field, defaultValue = null }) => {\n    set(initForm, field, defaultValue);\n  });\n  return WrapperdComponent =>\n    class extends React.Component {\n      constructor(props) {\n        super(props);\n        this.state = {\n          form: initForm || {}\n        };\n      }\n      resetFields = (form, depField, depValue) => {\n        forEach(settings, ({ dep, field, defaultValue = null }) => {\n          if (dep && dep.field === depField && dep.value !== depValue) {\n            set(form, field, defaultValue);\n            this.resetFields(form, field, defaultValue);\n          }\n        });\n      };\n      onChange = (field, value) => {\n        const form = this.state.form;\n        set(form, field, value);\n        this.resetFields(form, field, value);\n        this.setState({ form });\n      };\n      render() {\n        const form = {\n          values: this.state.form,\n          onChange: this.onChange\n        };\n        return (\n          <WrapperdComponent {...this.props} form={form} settings={settings} />\n        );\n      }\n    };\n};\n","import React, { Fragment } from \"react\";\nimport includes from \"lodash/includes\";\nimport pull from \"lodash/pull\";\nimport map from \"lodash/map\";\n\nexport class CheckBox extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: props.value || props.defaultValue || []\n    };\n  }\n  onChange = value => {\n    const onChange = this.props.form.onChange;\n    let stateValue = this.state.value;\n    if (includes(stateValue, value)) {\n      stateValue = pull(stateValue, value);\n    } else {\n      stateValue = [...stateValue, value];\n    }\n    this.setState({ value: stateValue }, () => {\n      onChange(this.props.field, this.state.value);\n    });\n  };\n  render() {\n    const { options, field, value: fieldValue } = this.props;\n    return (\n      <Fragment>\n        {map(options, ({ text, value }) => {\n          return (\n            <span key={value}>\n              <input\n                type=\"checkbox\"\n                name={field}\n                value={value}\n                checked={includes(fieldValue, value)}\n                onChange={() => this.onChange(value)}\n              />\n              <span>{text}</span>\n            </span>\n          );\n        })}\n      </Fragment>\n    );\n  }\n}\n","import React, { Fragment } from \"react\";\nimport { includes, map, get, find, isEqual, isFunction } from \"lodash\";\nimport { CheckBox } from \"./checkbox.js\";\nconst multiTypes = [\"radio\", \"checkbox\"];\n\nexport class Item extends React.Component {\n  render() {\n    const { form, field: name, settings } = this.props;\n    const setting = find(settings, { field: name });\n    const { dep, field, type, options } = setting;\n\n    if (dep) {\n      let satisfy = false;\n      const depValue = get(form, `values.${dep.field}`);\n      if (isFunction(dep.value)) {\n        satisfy = dep.value(depValue);\n      } else if (isEqual(depValue, dep.value)) {\n        satisfy = true;\n      }\n      if (!satisfy) return null;\n    }\n    if (includes(multiTypes, type)) {\n      const fieldValue = get(form, `values.${field}`);\n      if (type === \"checkbox\") {\n        return <CheckBox {...this.props} {...setting} value={fieldValue} />;\n      }\n      return (\n        <Fragment>\n          {map(options, ({ text, value }) => {\n            return (\n              <span key={value}>\n                <input\n                  type={type}\n                  name={field}\n                  value={value}\n                  checked={fieldValue === value}\n                  onChange={e => form.onChange(field, value)}\n                />\n                <span>{text}</span>\n              </span>\n            );\n          })}\n        </Fragment>\n      );\n    }\n    return (\n      <input type={type} onChange={e => form.onChange(field, e.target.value)} />\n    );\n  }\n}\n"],"names":["form","initForm","settings","field","defaultValue","props","resetFields","depField","depValue","dep","value","onChange","state","setState","React","Component","CheckBox","stateValue","includes","pull","options","fieldValue","text","multiTypes","Item","name","setting","find","type","satisfy","get","isFunction","isEqual","e","target"],"mappings":"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"}